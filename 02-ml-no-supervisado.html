<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2&nbsp; Aprendizaje máquina no supervisado – Visualización de datos espaciales con R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03-clust-part.html" rel="next">
<link href="./01-introduccion.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-04e1f1103201cc0a83f720091ef4aae4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01-introduccion.html">Fundamentos</a></li><li class="breadcrumb-item"><a href="./02-ml-no-supervisado.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Aprendizaje máquina no supervisado</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Visualización de datos espaciales con R</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefacio</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Fundamentos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-introduccion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introducción</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-ml-no-supervisado.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Aprendizaje máquina no supervisado</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Clustering</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-clust-part.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Clustering particionado</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-clust-jer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Clustering jerárquico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-mapas-auto-org.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Mapas auto-organizados</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Reducción de dimensionalidad</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-reduccion-dim.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Reducción de la dimensionalidad</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-autocodificadores.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Autocodificaciores</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Aplicaciones</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-apps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Aplicaciones</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-add-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Recursos adicionales</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Apéndices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A-command-ref.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Referencia de comandos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./B-packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Paquetes R empleados</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-refs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referencias</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#clustering" id="toc-clustering" class="nav-link active" data-scroll-target="#clustering"><span class="header-section-number">2.1</span> Clustering</a>
  <ul class="collapse">
  <li><a href="#clustering-no-jerárquico" id="toc-clustering-no-jerárquico" class="nav-link" data-scroll-target="#clustering-no-jerárquico"><span class="header-section-number">2.1.1</span> Clustering no jerárquico</a></li>
  <li><a href="#clustering-jerárquico" id="toc-clustering-jerárquico" class="nav-link" data-scroll-target="#clustering-jerárquico"><span class="header-section-number">2.1.2</span> Clustering jerárquico</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01-introduccion.html">Fundamentos</a></li><li class="breadcrumb-item"><a href="./02-ml-no-supervisado.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Aprendizaje máquina no supervisado</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-unsupervised-ml" class="quarto-section-identifier"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Aprendizaje máquina no supervisado</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="clustering" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="clustering"><span class="header-section-number">2.1</span> Clustering</h2>
<p>El análisis <em>cluster</em> (agrupamiento) identifica grupos de objetos basándose únicamente en la información que proporcionan los datos que describen esos objetos y sus relaciones entre sí. El <strong>objetivo</strong> es que los objetos asignados al mismo grupo se similares o estén relacionados entre sí y, a su vez, sean distintos (o no estén relacionados) con los elementos en otros grupos. En consecuencia, cuanto mayor sea la <strong>homogeneidad</strong> dentro de un mismo grupo y mayor sea la diferencia entre grupos, mejor o más distintivo será el <em>clustering</em> <span class="citation" data-cites="tan2019">(<a href="references.html#ref-tan2019" role="doc-biblioref">Tan et&nbsp;al., 2019</a>)</span>.</p>
<p>Sin embargo, identificar los posibles agrupamientos en un conjunto de datos no es tan sencillo como puede parecer a primera vista. La <a href="#fig-four-clusters" class="quarto-xref">Figura&nbsp;<span>2.1</span></a> muestra un conjunto de tan sólo 20 elementos en el que podemos formar, al menos, tres posibles agrupamientos de 2, 4 y 6 grupos, respectivamente. ¿Cuál es la mejor opción? En muchos casos, no sólo depende de las métricas de evaluación que utilicemos, sino también de las descripciones disponibles sobre los datos y del conocimiento del dominio de aplicación del problema.</p>
<div id="fig-four-clusters" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-four-clusters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/four-clusters.png" class="img-fluid figure-img" style="width:95.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-four-clusters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;2.1: Un conjunto de 20 elmentos y cuatro posibles agrupamientos, con distinto número de grupos en cada caso. Basado en la Fig. 5.1 de <span class="citation" data-cites="tan2019">(<a href="references.html#ref-tan2019" role="doc-biblioref">Tan et&nbsp;al., 2019</a>)</span>.
</figcaption>
</figure>
</div>
<p>Existen diferentes tipos de algoritmos de agrupamiento o <em>clustering</em>, en función de las propiedades de los grupos que obtenemos como resultado del proceso.</p>
<ul>
<li><strong>Clústering jerárquico</strong> (o anidado): en este caso el resultado son agrupamientos anidados, unos dentro de los otros, que conforman una jerarquía de grupos. Según la estrategia empleada para crear los grupos, pueden ser:
<ul>
<li><em>Aglomerativos</em>: se parte de un primer grupo de datos, y se van uniendo progresivamente los siguientes grupos de datos más similares, hasta que todos los datos quedan en un único grupo a alto nivel. Normalmente, este algoritmo recibe el nombre de AGNES (AGlomerative NESting) <span class="citation" data-cites="boehmke2019">(<a href="references.html#ref-boehmke2019" role="doc-biblioref">Boehmke &amp; Greenwell, 2019</a>)</span>. Es mejor detectando grupos de pequeño tamaño, con pocos elementos.</li>
<li><em>Divisivos</em>: se comienza considerando a todos los datos dentro de un mismo grupo, y progresivamente se van dividiendo en grupos anidados, de modo que los elementos más cercanos queden en el mismo grupo. Este algoritmo se denomina con frecuencia DIANA (DIvise ANAlysis). Es más adecuado para detectar grupos de gran tamaño, con muchos elementos.</li>
</ul></li>
<li><strong>Clústering partitivo (no jerárquico)</strong>: propone una división sin solape entre los grupos de elementos, de forma que cada grupo contenga elementos parecidos entre sí. Lo normal es que sigan un procedimiento iterativo para resolver el problema, cuya solución exacta no se puede hallar computacionalmente.</li>
</ul>
<p>En función de si existe o no solape entre los grupos tenemos:</p>
<ul>
<li><strong>Clustering sin solape</strong>: es el tipo de clustering propuesto por los algoritmos partitivos. También hay que considerar el clustering jerárquico como sin solape, puesto que la relación entre agrupamientos anidados se produce a distintos niveles (no es lo mismo un solape entre dos grupos al mismo nivel que el hecho de que un grupo esté contenido en otro de mayor nivel jerárquico).</li>
<li><strong>Clustering con solape</strong> (no exclusivo): permite que un elemento pueda pertenecer a más de un grupo a la vez. Es decir, pueden existir solapes entre las regiones definidas para cada grupo.</li>
<li><strong>Clustering difuso</strong> (<em>fuzzy clustering</em>): todo objeto pertenece a todos los agrupamientos con un cierto grado (peso) de pertenencia entre 0 (no pertenece en absoluto) y 1 (pertenece con toda seguridad). Usualmente, se impone la condición adicional de que la suma de los pesos asignados a un elemento sea 1. En el <em>clustering probabilístico</em> los pesos asignados son probabilidades de pertenencia a un grupo. Lo normal es que este tipo de técnicas produzcan agrupamientos <em>exclusivos</em>, asignando cada elemento al grupo que tenga el peso o probabilidad de pertenencia más alta.</li>
</ul>
<p>Por último, se puede tratar todo el dataset o sólo una parte:</p>
<ul>
<li><strong>Clustering completo</strong>: todos los elementos deben pertenecer, al menos, a un grupo.</li>
<li><strong>Clustering parcial</strong>: algunos elementos pueden no pertenecer a ningún grupo. La motivación de este tipo de soluciones es que pueden existir elementos de nuestro conjunto de datos que no pertenezcan a grupos bien definidos, se consideren ruido o sean atípicos que no proporcionan información (pero mucho cuidado con fallar en esa interpretación) <span class="citation" data-cites="tan2019">(<a href="references.html#ref-tan2019" role="doc-biblioref">Tan et&nbsp;al., 2019</a>)</span>.</li>
</ul>
<p>Por último, para generar los agrupamientos los algoritmos pueden fijarse en diferentes <em>propiedades</em> o características de los datos. Si buscamos agrupamientos <strong>bien separados</strong>, se procurará agrupar elementos cercanos entre sí y separados de los elementos en otros grupos. Los algoritmos <strong>basados en prototipos</strong> asignan los elementos a un agrupamiento en función de su distancia al <em>prototipo</em> (elemento representativo) de ese agrupamiento. Con frecuencia se denomian <em>clusters basados en centros</em>. Las estrategias <strong>basadas en grafos</strong> agrupan elementos en función de su grado de conexión en una red. Los métodos <strong>basados en densidad</strong> agrupan regiones con gran densidad de objetos contiguos los unos a los otros, separadas por otras regiones menos densas a su alrededor. Se emplean usualmente con grupos de formas irregulares o entrecruzados, cuando hay presencia de ruido y valores atípicos <span class="citation" data-cites="tan2019">(<a href="references.html#ref-tan2019" role="doc-biblioref">Tan et&nbsp;al., 2019</a>)</span>. Por último, en los <strong>métodos conceptuales</strong> se agrupan elementos que compartan propiedades comunes.</p>
<section id="clustering-no-jerárquico" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="clustering-no-jerárquico"><span class="header-section-number">2.1.1</span> Clustering no jerárquico</h3>
<section id="k-means" class="level4" data-number="2.1.1.1">
<h4 data-number="2.1.1.1" class="anchored" data-anchor-id="k-means"><span class="header-section-number">2.1.1.1</span> <em>k</em>-means</h4>
<p>Es un algoritmo de <em>clustering</em> <strong>particionado</strong>, basado en <strong>prototipos</strong>. El número total de grupos a identificar, denotado por <span class="math inline">\(k\)</span>, debe ser <em>definido por el usuario</em>. Cada grupo está representado por un <strong>centroide</strong>, que es un elemento <em>ficticio</em> (no un elemento real del dataset), que representa el punto de referencia o representativo de todos los elementos incluidos en su grupo.</p>
<p>La <a href="#fig-kmeans-clust" class="quarto-xref">Figura&nbsp;<span>2.2</span></a> muestra gráficamente el proceso iterativo de definición de los agrupamientos hasta llegar a una solución convergente (pero que puede no ser óptima). Se trata de un problema NP-hard, que debe resolverse mediante heurísticos aproximados que no garantizan la mejor solución, aunque se pueden tomar medidas para encontrar buenos agrupamientos.</p>
<div id="fig-kmeans-clust" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-kmeans-clust-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/K-means-convergence.gif" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-kmeans-clust-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;2.2: Proceso iterativo para definir los agrupamientos en el algoritmo <em>k</em>-means. Fuente: Wikipedia
</figcaption>
</figure>
</div>
<p>Si denotamos como <span class="math inline">\(C_1, \dots, C_k\)</span> los conjuntos que contienen los índices de las observaciones que se asignan a cadad grupo, dichos conjuntos satisfacen dos propiedades:</p>
<ol type="1">
<li><span class="math inline">\(C_1 \cup C_2 \cup \dots \cup C_k = {1, \dots, n}\)</span>; es decir, cada observación pertenece al menos a uno de los conjuntos.</li>
<li><span class="math inline">\(C_j \cap C_{j'} = \emptyset;\, \forall j \neq j'\)</span>, es decir, los clusters no tienen solape entre sí y ninguna observación pertenece a más de un cluster.</li>
</ol>
<p>El objetivo que persigue <em>k</em>-means es que la <em>variación intra-cluster</em> sea lo más pequeña posible. En inglés, esa <strong>within-cluster variation</strong> para el grupo <span class="math inline">\(C_j\)</span> es una medida <span class="math inline">\(W(C_j)\)</span> de la cantidad de diferencia que existe entre los elementos asignados a ese grupo. Por tanto, el objetivo es resolver el problema expresado por la <a href="#eq-k-means-obj" class="quarto-xref">Ecuación&nbsp;<span>2.1</span></a>:</p>
<p><span id="eq-k-means-obj"><span class="math display">\[
min_{C_1,\dots,C_k} \left\{ \sum_{j=1}^k W(C_j) \right\}
\tag{2.1}\]</span></span></p>
<p>En otras palabras, se pretende minimizar la suma en todos los grupos de la variación registrada dentro de cada grupo. Si utilizamos la distancia Euclídea, entonces W(C_k) se convierte en la función conocida como Within-Cluster Sum of Squares (WCSS).</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Otras métricas de distancia en <em>k</em>-means
</div>
</div>
<div class="callout-body-container callout-body">
<p>Debemos tener mucho cuidado con la utilzación del algoritmo <em>k</em>-means si queremos emplear otras funciones métricas de distancia distintas de la distancia Euclídea (norma <span class="math inline">\(L_2\)</span>). La mayoría de paquetes y bibliotecas software <strong>asumen por defecto</strong> que se va a utilizar dicha distancia, ya que la función objetivo que se plantea en el problema de optimización que debe resolver es, precisamente, minimizar el WCSS. Como acabamos de ver arriba, este criterio *sólo es valido para la distancia Euclídea**. Existen algunas implementaciones del algoritmo con otras funciones de distancia, pero no son para nada habituales.</p>
</div>
</div>
</section>
<section id="k-medoids" class="level4" data-number="2.1.1.2">
<h4 data-number="2.1.1.2" class="anchored" data-anchor-id="k-medoids"><span class="header-section-number">2.1.1.2</span> <em>k</em>-medoids</h4>
<p>Es un algoritmo clásico de particionado que divide el conjunto de datos en <span class="math inline">\(k\)</span> grupos. Nuevamente, este valor <span class="math inline">\(k\)</span> debe ser <em>definido por el usuario</em>. A diferencia del método anterior, este algoritmo identifica un elemento <em>real</em> de los datos como el <em>prototipo</em> o representante de los elementos incluidos en su grupo. Esto facilita mucho la interpretación de los resultados. El nombre del algoritmo fue popularizado por L. Kaufman y P.J. Rousseeuw con su algoritmo PAM (<em>Partitioning Around Medoids</em>).</p>
<p>La <a href="#fig-kmedoids-clust" class="quarto-xref">Figura&nbsp;<span>2.3</span></a> muestra visualmente el proceso iterativo para encontrar los agrupamientos.</p>
<div id="fig-kmedoids-clust" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-kmedoids-clust-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/K-Medoids-Clustering.gif" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-kmedoids-clust-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;2.3: Proceso iterativo para definir los agrupamientos en el algoritmo <em>k</em>-medoids. Fuente: Wikipedia
</figcaption>
</figure>
</div>
<p>Como ocurría en el caso de <em>k</em>-means, se trata de un problema NP-hard para el que no se puede obtener una solución exacta, por lo que se suelen emplear heurísticos para solucionarlo. En el <a href="03-clust-part.html" class="quarto-xref"><span>Capítulo 3</span></a> veremos algunos ejemplos de variantes para solucionarlo implementadas en R.</p>
</section>
<section id="dbscan" class="level4" data-number="2.1.1.3">
<h4 data-number="2.1.1.3" class="anchored" data-anchor-id="dbscan"><span class="header-section-number">2.1.1.3</span> DBSCAN</h4>
<p>DBSCAN (<em>Density-Based Spatial Clustering of Applications with Noise</em>) es un algoritmo de agrupamiento basado en la densidad. A diferencia de métodos como <em>k</em>-means, que asumen que los clústeres quedan definidos por regiones de Voronoi basadas en la función de distancia (típicamente hiperesferas con distancia Euclídea), DBSCAN define los clústeres como regiones continuas de alta densidad de puntos, separadas por regiones de baja densidad.</p>
<p>Su funcionamiento se rige por dos parámetros globales:</p>
<ul>
<li><span class="math inline">\(\varepsilon\)</span>: define el radio de vecindad alrededor de cada punto.</li>
<li><span class="math inline">\(minPts\)</span>: mínimo número de puntos que deben caer dentro del radio de vecindad <span class="math inline">\(\varepsilon\)</span> para que esa región se considere <em>densa</em>.</li>
</ul>
<p>En base a estos parámetros, el algoritmo clasifica los elementos del dataset en tres posibles categorías:</p>
<ol type="1">
<li>Punto Núcleo (<em>Core Point</em>): un punto <span class="math inline">\(p\)</span> es un núcleo si su vecindad <span class="math inline">\(\varepsilon\)</span> contiene al menos <span class="math inline">\(minPts\)</span> elementos (incluyéndose a sí mismo).</li>
<li>Punto Frontera (<em>Border Point</em>): un punto <span class="math inline">\(q\)</span> es frontera si es alcanzable desde un punto núcleo (está dentro de su distancia <span class="math inline">\(\varepsilon\)</span>), pero tiene menos de <span class="math inline">\(minPts\)</span> en su propia vecindad.</li>
<li>Ruido (<em>Noise/Outlier</em>): un punto es ruido si no es ni núcleo ni frontera.</li>
</ol>
<p>A diferencia de los dos ejemplos anteriores, DBSCAN no requiere especificar <span class="math inline">\(k\)</span>, sino que el algoritmo puede determinar el número de agrupamientos según la densidad de los datos. Es especialmente propicio para detectar grupos con formas geométricas “complejas” (no convexas), como el “swiss roll”, arcos, anillos o zig-zags. Además, su diseño está pensado para detectar y filtrar los elementos que se consideren “ruido”. Se utiliza con frecuencia en bases de datos espaciales. No obstante, también tiene limitaciones, ya que puede tener dificultades en datasets con densidad variable en diferentes regiones o con datasets representados en espacios de alta dimensionalidad.</p>
</section>
</section>
<section id="clustering-jerárquico" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="clustering-jerárquico"><span class="header-section-number">2.1.2</span> Clustering jerárquico</h3>
<p>En el clustering jerárquico, los agrupamientos están anidados y pueden formar una estructura jerárquica, que se suele representar gráficamente en forma de un árbol llamado <strong>dendograma</strong>, como el que se presenta en la <a href="#fig-dendogram" class="quarto-xref">Figura&nbsp;<span>2.4</span></a>.</p>
<div id="fig-dendogram" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dendogram-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/dendrogram.png" class="img-fluid figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dendogram-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;2.4: Ejemplo de un dendograma que representa los agrupamientos encontrados tras aplicar un algoritmo de <em>clustering</em> jerárquico. Fuente: Figura 21.1 de <span class="citation" data-cites="boehmke2019">(<a href="references.html#ref-boehmke2019" role="doc-biblioref">Boehmke &amp; Greenwell, 2019</a>)</span>.
</figcaption>
</figure>
</div>
<p>Debemos tener presente que, en función del nivel en el que “cortemos” el dendograma, obtendremos un número diferente de grupos. Por ejemplo, la <a href="#fig-dendogram-cuts" class="quarto-xref">Figura&nbsp;<span>2.5</span></a></p>
<div id="fig-dendogram-cuts" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dendogram-cuts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/dendogram-cuts.png" class="img-fluid figure-img" style="width:95.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dendogram-cuts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;2.5: Tres dendogramas que muestran diferentes cortes a distinto nivel del árbol. Izq.: dendograma original (sin cortes); (centro) corte a nivel 9, que genera dos agrupamientos; (dcha.) corte a nivel 5, que define 3 agrupamientos. Fuente: Figura 12.11 de <span class="citation" data-cites="james2021">(<a href="references.html#ref-james2021" role="doc-biblioref">James, 2021</a>)</span>.
</figcaption>
</figure>
</div>
<section id="agnes" class="level4" data-number="2.1.2.1">
<h4 data-number="2.1.2.1" class="anchored" data-anchor-id="agnes"><span class="header-section-number">2.1.2.1</span> AGNES</h4>
<p>El método de <em>clustering</em> aglomerativo parte de un conjunto de <span class="math inline">\(n\)</span> grupos, uno por cada elemento de nuestro dataset. En cada iteración, une los dos grupos más similares hasta que se obtenga un único grupo que contiene a todos los datos.</p>
<p>Para ello, se necesita establecer un criterio de “enlace” para fusionar los grupos, que determine la distancia entre dos agrupamientos. Se pueden usar varios criterios:</p>
<ul>
<li><p><em>Agrupamiento de enlace completo</em>: minimiza la distancia máxima entre las parejas de observaciones de dos agrupamientos.</p></li>
<li><p><em>Agrupamiento de enlace promedio</em>: minimizar la media de las distancias entre las observaciones pertenecientes a dos clusteres (calculadas por pares).</p></li>
<li><p><em>Agrupamiento de enlace mínimo o simple</em>: minimizar las distancias entre las observaciones más cercanas en dos clústers.</p></li>
<li><p><em>Método de Ward</em>: minimizar la suma de las diferencias cuadráticas dentro de los clusteres. De ese modo, se minimiza la varianza total del conglomerado.</p></li>
<li><p><em>Enlace de centroides</em>: se calcula la distancia entre el centroide del grupo A y el centroide del grupo B.</p></li>
</ul>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-boehmke2019" class="csl-entry" role="listitem">
Boehmke, B., &amp; Greenwell, B. (2019). <em>Hands-On Machine Learning with R</em> (1.ª ed.). Chapman; Hall/CRC. <a href="https://doi.org/10.1201/9780367816377">https://doi.org/10.1201/9780367816377</a>
</div>
<div id="ref-james2021" class="csl-entry" role="listitem">
James, W., G. (2021). <em><span>An Introduction to Statistical Learning with Applications in R</span></em> (2.ª ed.). Springer. <a href="https://www.statlearning.com/">https://www.statlearning.com/</a>
</div>
<div id="ref-tan2019" class="csl-entry" role="listitem">
Tan, P.-N., Steinbach, M. S., Karpatne, A., &amp; Kumar, V. (2019). <em>Introduction to Data Mining (Second Edition)</em>. Pearson.
</div>
</div>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./01-introduccion.html" class="pagination-link" aria-label="Introducción">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introducción</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03-clust-part.html" class="pagination-link" aria-label="Clustering particionado">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Clustering particionado</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>